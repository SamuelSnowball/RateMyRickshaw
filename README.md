# RateMyRickshaw ğŸ›º

AI-powered rickshaw detection and analysis application using AWS Rekognition, Quarkus Lambda, and React.

Useful commands:

Run locally: mvn quarkus:dev -Dquarkus.test.continuous-testing=disabled


# 1. Build with Maven (creates target/function.zip)
mvn clean package

# 2. Test locally

Request formats:
// URL
{"imageUrl": "https://example.com/rickshaw.jpg"}

// Base64 (generated by script)
{"imageBase64": "data:image/jpeg;base64,/9j/4AAQ..."}


Run generate-event.sh to create the event.json String
curl -X POST http://localhost:8080 \
  -H "Content-Type: application/json" \
  -d @event.json


sam local invoke RickshawAnalysisFunction -e event.json

## Deployment
# First time deployment
./deploy-sam.sh

# Or manually:
mvn clean package
sam deploy --guided

# Check deployment status
./get-deployment-info.sh

# Test the API
./test-api.sh


## Architecture

- **Backend**: Quarkus Java application running on AWS Lambda
- **AI/ML**: AWS Rekognition for image analysis
- **API**: AWS API Gateway (REST API with CORS)
- **Frontend**: React single-page application hosted on S3
- **Region**: eu-west-2 (London)

## Features

- ğŸ–¼ï¸ Image analysis using AWS Rekognition
- ğŸ›º Rickshaw detection with confidence scoring
- ğŸ·ï¸ Object/label detection with confidence scores
- âš¡ Fast cold start times with Quarkus on Lambda
- ğŸŒ Modern React UI with gradient design
- ğŸš€ One-command deployment

## Prerequisites

- Java 17+
- Maven 3.8+
- Node.js 16+ and npm
- AWS CLI configured with appropriate credentials
- AWS Account with permissions for:
  - Lambda
  - API Gateway
  - S3
  - IAM
  - Rekognition

## Project Structure

```
RateMyRickshaw/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â”œâ”€â”€ java/com/ratemyrickshaw/
â”‚       â”‚   â”œâ”€â”€ lambda/
â”‚       â”‚   â”‚   â””â”€â”€ RickshawAnalysisHandler.java
â”‚       â”‚   â”œâ”€â”€ model/
â”‚       â”‚   â”‚   â”œâ”€â”€ ImageAnalysisRequest.java
â”‚       â”‚   â”‚   â””â”€â”€ ImageAnalysisResponse.java
â”‚       â”‚   â””â”€â”€ service/
â”‚       â”‚       â””â”€â”€ RekognitionService.java
â”‚       â””â”€â”€ resources/
â”‚           â””â”€â”€ application.properties
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.js
â”‚   â”‚   â”œâ”€â”€ App.css
â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup-infrastructure.sh
â”‚   â”œâ”€â”€ deploy-lambda.sh
â”‚   â”œâ”€â”€ deploy-api-gateway.sh
â”‚   â””â”€â”€ deploy-frontend.sh
â”œâ”€â”€ pom.xml
â”œâ”€â”€ build.sh / build.bat
â””â”€â”€ deploy.sh
```

## Quick Start

### Option 1: Full Deployment (Recommended)

Deploy everything with a single command:

```bash
# Linux/Mac
chmod +x deploy.sh
./deploy.sh

# Windows - use Git Bash or WSL
bash deploy.sh
```

### Option 2: Step-by-Step Deployment

#### 1. Build the Lambda Function

```bash
# Linux/Mac
./build.sh

# Windows
build.bat
```

#### 2. Setup AWS Infrastructure

```bash
chmod +x scripts/setup-infrastructure.sh
./scripts/setup-infrastructure.sh
```

This creates:
- IAM role for Lambda with Rekognition and S3 permissions
- S3 bucket for static website hosting

#### 3. Deploy Lambda Function

```bash
chmod +x scripts/deploy-lambda.sh
./scripts/deploy-lambda.sh
```

#### 4. Deploy API Gateway

```bash
chmod +x scripts/deploy-api-gateway.sh
./scripts/deploy-api-gateway.sh
```

This creates:
- REST API with `/analyze` endpoint
- CORS configuration
- Lambda integration
- Production stage deployment

#### 5. Deploy Frontend

```bash
chmod +x scripts/deploy-frontend.sh
./scripts/deploy-frontend.sh
```

## API Usage

### Analyze Image from URL

```bash
curl -X POST https://YOUR_API_ID.execute-api.eu-west-2.amazonaws.com/prod/analyze \
  -H 'Content-Type: application/json' \
  -d '{
    "imageUrl": "https://example.com/rickshaw.jpg"
  }'
```

### Analyze Image from S3

```bash
curl -X POST https://YOUR_API_ID.execute-api.eu-west-2.amazonaws.com/prod/analyze \
  -H 'Content-Type: application/json' \
  -d '{
    "s3Bucket": "my-bucket",
    "s3Key": "images/rickshaw.jpg"
  }'
```

### Response Format

```json
{
  "success": true,
  "message": "Image analyzed successfully",
  "isRickshaw": true,
  "rickshawConfidence": 95.5,
  "labels": ["Vehicle", "Transportation", "Rickshaw", "Auto Rickshaw"],
  "labelConfidence": {
    "Vehicle": 99.8,
    "Transportation": 98.5,
    "Rickshaw": 95.5,
    "Auto Rickshaw": 94.2
  }
}
```

## Local Development

### Test Lambda Locally

```bash
./mvnw quarkus:dev
```

Then send requests to `http://localhost:8080`

### Run Frontend Locally

```bash
cd frontend
npm install
REACT_APP_API_ENDPOINT=http://localhost:8080 npm start
```

## Configuration

### Update AWS Region

Edit the following files:
- `scripts/setup-infrastructure.sh`
- `scripts/deploy-lambda.sh`
- `scripts/deploy-api-gateway.sh`
- `scripts/deploy-frontend.sh`

Change `REGION="eu-west-2"` to your preferred region.

### Update App Name

Change `APP_NAME="ratemyrickshaw"` in all deployment scripts.

**Note**: S3 bucket names must be globally unique. You may need to choose a different name.

## Performance

- **Cold Start**: ~1-2 seconds (Quarkus on JVM)
- **Warm Start**: ~100-300ms
- **Image Analysis**: Depends on Rekognition (typically 1-3 seconds)

## Costs

Estimated monthly costs (low traffic):
- Lambda: ~$0.20 (1M requests/month)
- API Gateway: ~$3.50 (1M requests/month)
- Rekognition: ~$1 per 1,000 images
- S3: ~$0.50 (hosting + requests)

**Total**: ~$5-10/month for moderate usage

## Troubleshooting

### Build fails

Ensure Java 17+ and Maven 3.8+ are installed:
```bash
java -version
mvn -version
```

### Deployment fails

Check AWS CLI configuration:
```bash
aws sts get-caller-identity
aws configure list
```

### CORS errors

Verify API Gateway CORS configuration in the AWS Console.

### Lambda timeout

Increase timeout in `scripts/deploy-lambda.sh` (default: 30 seconds)

## Clean Up

To remove all AWS resources:

```bash
# Delete Lambda function
aws lambda delete-function --function-name ratemyrickshaw-lambda --region eu-west-2

# Delete API Gateway
API_ID=$(aws apigateway get-rest-apis --region eu-west-2 --query "items[?name=='ratemyrickshaw-api'].id" --output text)
aws apigateway delete-rest-api --rest-api-id $API_ID --region eu-west-2

# Empty and delete S3 bucket
aws s3 rm s3://ratemyrickshaw --recursive
aws s3 rb s3://ratemyrickshaw --region eu-west-2

# Delete IAM role (detach policies first)
aws iam detach-role-policy --role-name ratemyrickshaw-lambda-role --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
aws iam detach-role-policy --role-name ratemyrickshaw-lambda-role --policy-arn arn:aws:iam::aws:policy/AmazonRekognitionReadOnlyAccess
aws iam detach-role-policy --role-name ratemyrickshaw-lambda-role --policy-arn arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
aws iam delete-role --role-name ratemyrickshaw-lambda-role
```

## License

MIT

## Contributing

Pull requests are welcome! For major changes, please open an issue first.
# RateMyRickshaw
